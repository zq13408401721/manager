(function(t){function e(e){for(var a,s,r=e[0],l=e[1],c=e[2],u=0,h=[];u<r.length;u++)s=r[u],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&h.push(i[s][0]),i[s]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);d&&d(e);while(h.length)h.shift()();return n.push.apply(n,c||[]),o()}function o(){for(var t,e=0;e<n.length;e++){for(var o=n[e],a=!0,r=1;r<o.length;r++){var l=o[r];0!==i[l]&&(a=!1)}a&&(n.splice(e--,1),t=s(s.s=o[0]))}return t}var a={},i={app:0},n=[];function s(e){if(a[e])return a[e].exports;var o=a[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=t,s.c=a,s.d=function(t,e,o){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(o,a,function(e){return t[e]}.bind(null,a));return o},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var d=l;n.push([0,"chunk-vendors"]),o()})({0:function(t,e,o){t.exports=o("56d7")},"034f":function(t,e,o){"use strict";o("85ec")},"3af0":function(t,e,o){},4446:function(t,e,o){"use strict";o("6d3f")},"54b4":function(t,e,o){"use strict";o("9c99")},"56d7":function(t,e,o){"use strict";o.r(e);o("e260"),o("e6cf"),o("cca6"),o("a79d");var a=o("2b0e"),i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"app"}},[o("router-view")],1)},n=[],s={name:"App",components:{},mounted:function(){this.$router.push("/login")}},r=s,l=(o("034f"),o("2877")),c=Object(l["a"])(r,i,n,!1,null,null,null),d=c.exports,u=o("bc3a"),h=o.n(u),p=o("2106"),f=o.n(p),g=o("8c4f"),m=o("f825"),v=o.n(m),y=(o("f8ce"),o("76fe"),o("b970")),C=(o("157a"),o("9012")),w=o.n(C),b=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("v-form",{staticClass:"box",attrs:{direction:"horizontal"}},[o("v-form-item",{attrs:{label:"用户名","label-col":t.labelCol,"wrapper-col":t.wrapperCol}},[o("v-input",{attrs:{type:"text",placeholder:"用户名"},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}})],1),o("v-form-item",{attrs:{label:"密码","label-col":t.labelCol,"wrapper-col":t.wrapperCol,required:""}},[o("v-input",{attrs:{type:"password",placeholder:"密码"},model:{value:t.pw,callback:function(e){t.pw=e},expression:"pw"}})],1),o("v-form-item",{staticStyle:{"margin-top":"24px"},attrs:{"wrapper-col":{span:20}}},[o("v-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("确定")])],1)],1)],1)},x=[],N=(o("d3b7"),"manager-token"),A="schoolid";function k(t){localStorage.setItem(N,t)}function I(){return localStorage.getItem(N)}function _(t){localStorage.setItem(A,t)}function S(){return localStorage.getItem(A)}var D="http://server.yimios.com/",R={post:function(t,e){var o=I();return new Promise((function(a,i){h.a.defaults.headers.common["art-token"]=o,h.a.post(D+t,e).then((function(t){a(t)})).catch((function(t){i(t)}))}))},get:function(t,e){return new Promise((function(o,a){h.a.defaults.headers.common["art-token"]=I(),h.a.get(D+t,e).then((function(t){o(t)})).catch((function(t){a(t)}))}))},upload:function(t,e){var o=I();return new Promise((function(a,i){h.a.defaults.headers.common["art-token"]=o,h.a.defaults.headers.common["Content-Type"]="multipart/form-data",h.a.post(D+t,e).then((function(t){a(t)})).catch((function(t){i(t)}))}))},uploadMore:function(t,e){var o=I();return new Promise((function(a,i){h.a.defaults.headers.common["art-token"]=o,h.a.defaults.headers.common["Content-Type"]="multipart/form-data",h.a.defaults.headers.common["processData"]="false",h.a.post(D+t,e).then((function(t){a(t)})).catch((function(t){i(t)}))}))},uploadFile:function(t,e,o,a){var i=I();return new Promise((function(n,s){var r=new XMLHttpRequest;r.open("post",t),r.setRequestHeader("art-token",i),r.onreadystatechange=function(){4==r.readyState&&200==r.status&&(console.log("上传准备就绪"),n(o))},r.upload.onprogress=function(t){if(t.lengthComputable){var e=t.loaded/t.total*100;console.log("porgress:"+e),a(o,e)}},r.send(e)}))}};function B(t){return console.log("login"),R.post("api/user/adminLogin",t)}function V(t){return console.log("categorylist"),R.post("api/video/videoCategoryList",t)}function O(t){return console.log("videocategory"),R.post("api/video/addVideoCategory",t)}function L(t){return R.post("api/user/register",t)}function z(t){return R.get("api/user/getUserList",t)}function E(t){return console.log("addvideocategory"),R.post("api/video/updateVideoCategory",t)}function T(t){return R.post("api/video/updateVideoInfo",t)}function M(t){return console.log("deleteVideoCategory"),R.post("api/video/deleteVideoCategory",t)}function P(t){return R.post("api/video/categoryInfo",t)}function j(t){return R.post("api/video/addVideo",t)}function K(t){return R.post("api/video/videolist",t)}function F(t){return console.log("categorylist"),R.post("api/gallery/galleryCategoryList",t)}function W(t){return console.log("gallerycategory"),R.post("api/gallery/addGalleryCategory",t)}function U(t){return console.log("addvideocategory"),R.post("api/gallery/updateGalleryCategory",t)}function G(t){return console.log("deleteGalleryCategory"),R.post("api/gallery/deleteGalleryCategory",t)}function Y(t){return R.post("api/gallery/categoryInfo",t)}function X(t){return R.post("api/gallery/addGallery",t)}function J(t){return R.post("api/gallery/gallerylist",t)}function Z(t){return R.post("api/gallery/deleteGallery",t)}function H(t,e,o){return R.uploadFile("api/upload/uploadGalleryFile",t,e,o)}var q=o("8237"),Q=o.n(q),$={name:"Login.vue",data:function(){return{username:"",pw:"",labelCol:{span:10},wrapperCol:{span:12}}},methods:{submit:function(){var t=this;if(void 0!=this.username&&void 0!=this.pw){var e={username:this.username,password:Q()(this.pw)};console.log("param:"+e),B(e).then((function(e){console.log(e),200==e.data.data.code&&(k(e.data.data.data.userinfo.token),_(e.data.data.data.userinfo.school_id),t.$router.push({name:"/Home",params:{user:e.data.data}}))})).catch((function(t){console.log(t)}))}}}},tt=$,et=(o("c0d8"),Object(l["a"])(tt,b,x,!1,null,"1b366d90",null)),ot=et.exports,at=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[t._v(" 设置页面 ")])},it=[],nt={name:"setting"},st=nt,rt=Object(l["a"])(st,at,it,!1,null,"5afdc618",null),lt=rt.exports,ct=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[t._v(" 学校管理员 ")])},dt=[],ut={name:"manger"},ht=ut,pt=Object(l["a"])(ht,ct,dt,!1,null,"6e66bee8",null),ft=pt.exports,gt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("van-tabs",{on:{click:t.clickTabs}},[o("van-tab",{attrs:{title:"图库分类"}},[o("Row",{directives:[{name:"show",rawName:"v-show",value:t.isShowRoot,expression:"isShowRoot"}],staticStyle:{"margin-top":"10px","line-height":"40px"}},[o("Col",{attrs:{span:"8"}},[o("van-field",{attrs:{placeholder:"请输入根节点"},model:{value:t.rootName,callback:function(e){t.rootName=e},expression:"rootName"}})],1),o("Col",{staticStyle:{height:"40px","line-height":"40px"},attrs:{span:"4"}},[o("Button",{staticStyle:{"vertical-align":"middle"},attrs:{type:"primary"},on:{click:t.createRoot}},[t._v("创建根节点")])],1),o("Col",{staticStyle:{"text-align":"left","vertical-align":"middle"},attrs:{span:"12"}},[o("v-dropdown",{attrs:{data:t.rootNodes},on:{"item-click":t.rootNodeClick}},[o("a",{staticClass:"ant-dropdown-link ant-dropdown-trigger",attrs:{href:"javascript:void(0)"}},[o("span",{staticClass:"tag_font"},[t._v("选择根节点")]),t._v(" "),o("v-icon",{attrs:{type:"down"}})],1)]),o("span",{staticStyle:{"font-size":"16px"}},[t._v(t._s(t.currentRootNode.content))]),o("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:t.editRoot}},[t._v("编辑")]),o("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:t.deleteRoot}},[t._v("删除")])],1)],1),o("Row",{staticClass:"modify-row"},[o("Col",{staticClass:"item",attrs:{span:"16"}},[t._v("节点")]),o("Col",{staticClass:"item",attrs:{span:"4"}},[t._v("排序")]),o("Col",{staticClass:"item",attrs:{span:"4"}},[t._v("操作")])],1),o("div",{staticClass:"scrollbar"},[t.isRouterAlive?o("Tree",{staticClass:"tree-render",attrs:{render:t.renderContent,data:t.ClassifyData}}):t._e()],1)],1),o("van-tab",{attrs:{title:"上传图片"}},[o("GalleryUpload",{attrs:{treeData:t.ClassifyData}})],1),o("van-tab",{attrs:{title:"图片列表"}},[o("GalleryList",{ref:"galleryList"})],1)],1),o("NodePopWin",{ref:"popwin",attrs:{nodeName:t.currentNode},on:{select:t.popWinCB}})],1)},mt=[],vt=(o("b0c0"),o("a434"),o("7db0"),o("d399")),yt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("v-modal",{attrs:{title:"修改节点",visible:t.customTextVisible,"ok-text":"ok","cancel-text":"Cancel"},on:{ok:t.customTextOk,cancel:t.customTextCancel}},[o("v-input",{attrs:{placeholder:"节点名"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),o("br")],1)},Ct=[],wt={name:"WidgetPopWin",props:["nodeName"],data:function(){return{customTextVisible:!1,name:this.nodeName}},mounted:function(){this.$nextTick((function(){this.$on("showPopWindow",(function(t){console.log("Data:"+t)}))}))},methods:{showCustomTextModal:function(){},customTextOk:function(){this.customTextVisible=!1,this.name&&this.$emit("select",this.name)},customTextCancel:function(){this.customTextVisible=!1},showCustomTextConfirm:function(t){this.$modal.confirm({title:"修改节点",content:t,okText:"OK",cancelText:"Cancel"}),this.customTextVisible=!0}}},bt=wt,xt=Object(l["a"])(bt,yt,Ct,!1,null,"14c16d74",null),Nt=xt.exports,At=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"grid-demo"},[a("div",{staticClass:"overview"},[a("v-row",{staticClass:"demo-row row-nd"},[a("v-col",{staticClass:"demo-col demo-col-1",attrs:{span:"4"}},[t._v("选择分类")]),a("v-col",{staticClass:"demo-col demo-col-1",attrs:{span:"4"}},[a("Button",{on:{click:t.showSelectTree}},[t._v(t._s(t.selectCategoryName))])],1),a("v-col",{staticClass:"demo-col demo-col-2",attrs:{span:"16"}},[t._v("备注：只能选择到三级分类")])],1),a("v-row",{staticClass:"demo-row row-nd"},[a("v-col",{staticClass:"demo-col demo-col-1",attrs:{span:"4"}},[t._v("上传封面")]),a("v-col",{staticClass:"demo-col demo-col-1",attrs:{span:"4"}},[a("Button",{on:{click:t.showSelectImg}},[t._v("上传封面图")])],1),a("v-col",{staticClass:"demo-col demo-col-2",attrs:{span:"16"}},[t._v("备注：只能选择到三级分类")])],1),a("v-row",{staticClass:"demo-row",staticStyle:{"text-align":"left"}},[a("img",{directives:[{name:"show",rawName:"v-show",value:void 0!=this.cover&&this.cover.length>0,expression:"this.cover != undefined && this.cover.length > 0"}],staticStyle:{width:"50px",height:"50px","margin-left":"70px"},attrs:{src:this.cover}})]),a("v-row",{staticClass:"demo-row row-nd",staticStyle:{"margin-top":"10px"}},[a("v-col",{staticClass:"demo-col demo-col-1",attrs:{span:"4"}},[t._v("添加视频")]),a("v-col",{staticClass:"demo-col demo-col-1",attrs:{span:"4"}},[a("Button",{on:{click:t.showSelectVideo}},[t._v("上传图库")])],1),a("v-col",{staticClass:"demo-col demo-col-2",attrs:{span:"16"}},[t._v("备注：只能选择到三级分类")])],1)],1),a("v-row",{staticClass:"demo-row"},[a("List",{staticClass:"list",attrs:{"item-layout":"vertical"}},t._l(t.videos,(function(e){return a("ListItem",{key:e.name,staticStyle:{"text-align":"left"}},[a("span",{staticStyle:{width:"200px","word-wrap":"break-word","word-break":"break-all"}},[t._v(t._s(e.name))]),a("img",{staticStyle:{width:"50px",height:"50px"},attrs:{src:e.url}})])})),1)],1),a("Modal",{on:{"on-ok":t.treeOK},model:{value:t.showTreeNode,callback:function(e){t.showTreeNode=e},expression:"showTreeNode"}},[a("div",{staticClass:"scrollbar"},[a("Tree",{staticClass:"tree-render tree",attrs:{render:t.renderTreeContent,data:t.treeData},on:{"on-select-change":t.nodeClick}})],1)]),a("Modal",{attrs:{title:t.dialogtitle},on:{"on-ok":t.dialogOK,"on-cancel":t.dialogCancel},model:{value:t.showDialog,callback:function(e){t.showDialog=e},expression:"showDialog"}},[a("Upload",{ref:"file",attrs:{action:"http://server.yimios.com/api/upload/uploadImageFile","before-upload":t.selectImage,"on-success":t.uploadCoverSuccess,"on-error":t.uploadError,headers:t.header,data:t.filedata}},[a("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v("上传封面图")])],1)],1),a("Modal",{attrs:{title:t.dialogvideotitle},on:{"on-ok":t.dialogVideoOK,"on-cancel":t.dialogVideoCancel},model:{value:t.showVideoDialog,callback:function(e){t.showVideoDialog=e},expression:"showVideoDialog"}},[a("div",{staticClass:"box"},[a("div",{staticClass:"upload"},[a("div",{staticClass:"upload_warp"},[a("div",{staticClass:"upload_warp_left",on:{click:t.fileClick}},[a("img",{staticStyle:{height:"80px"},attrs:{src:o("cf55")}})]),a("Button",{attrs:{type:"primary"},on:{click:t.uploadMoreImage}},[t._v("上传")])],1),a("div",{staticClass:"upload_warp_text"},[t._v(" 选中"+t._s(t.imgList.length)+"张文件，共"+t._s(t.bytesToSize(this.size))+" ")]),a("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"upload_file",multiple:""},on:{change:function(e){return t.fileChange(e)}}}),a("div",{directives:[{name:"show",rawName:"v-show",value:0!=t.imgList.length,expression:"imgList.length!=0"}],staticClass:"upload_warp_img"},t._l(t.imgList,(function(e){return a("div",{key:e.name,staticClass:"upload_warp_img_div"},[a("div",{staticClass:"upload_warp_img_div_top"},[t._v(" 上传进度"+t._s(e.persent)+"% "),a("div",{staticClass:"upload_warp_img_div_text"},[t._v(" "+t._s(e.file.name)+" ")])]),a("img",{attrs:{src:e.file.src}})])})),0)])])]),a("Spin",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],attrs:{fix:""}},[a("div",{staticClass:"loader"},[a("svg",{staticClass:"circular",attrs:{viewBox:"25 25 50 50"}},[a("circle",{staticClass:"path",attrs:{cx:"50",cy:"50",r:"20",fill:"none","stroke-width":"5","stroke-miterlimit":"10"}})])])])],1)},kt=[],It={name:"WidgetGalleryUpLoad",props:{treeData:[]},data:function(){return{dialogtitle:"图库封面图上传",dialogvideotitle:"图库上传",selectCategoryName:"请选择分类",selectCategoryId:0,cover:"",videos:[],videoUrl:"",showDialog:!1,showVideoDialog:!1,showTreeNode:!1,file:null,header:{},filedata:{},categoryid:0,video:null,videodata:{},videoheader:{},loading:!1,categoryInfo:[],imgList:[],imgFiles:[],size:0}},mounted:function(){this.filedata.type="gallery",this.videodata.type="gallery"},methods:{showSelectTree:function(){this.showTreeNode=!0},showSelectImg:function(){0==this.selectCategoryId?Object(vt["a"])("请选择课程节点"):(this.showDialog=!0,this.header["art-token"]=I())},selectImage:function(t){return this.file=t,this.loading=!0,!0},dialogOK:function(){console.log("ok")},dialogCancel:function(){console.log("cancel")},uploadMoreImage:function(){var t=this;console.log(this.imgList.length);for(var e=this,o=[],a=new FormData,i=0;i<this.imgList.length;i++)o.push({name:this.imgList[i].file.name,type:this.imgList[i].file.type,size:this.imgList[i].file.size,file:this.imgList[i].file}),a.append("cid",this.selectCategoryId),a.append("file",this.imgList[i].file),a.append("type",1),a.append("schoolid",S()),H(a,this.imgList[i].file.name,(function(t,o){console.log("上传进度："+o),e.uploadPersent(t,o)})).then((function(e){console.log("res:"+e),t.deleteUploadSuccess(e)})).catch((function(t){console.log("上传失败："+t)}))},uploadPersent:function(t,e){for(var o=0;o<this.imgList.length;o++)if(this.imgList[o].file.name==t){this.imgList[o].persent=e;break}},deleteUploadSuccess:function(t){for(var e=0;e<this.imgList.length;e++)if(this.imgList[e].file.name==t){this.imgList.splice(e,1);break}},uploadCoverSuccess:function(t,e,o){var a=this;console.log(t),this.cover=t.data.url;var i={id:this.selectCategoryId,cover:this.cover};U(i).then((function(t){a.loading=!1})).catch((function(t){console.log("updatecategory err "+t),a.loading=!1}))},uploadError:function(t,e,o){console.log(t)},showSelectVideo:function(){0==this.selectCategoryId?Object(vt["a"])("请先选择课程节点或封面图片"):(this.showVideoDialog=!0,this.videoheader["art-token"]=I())},selectVideo:function(t){return this.video=t,!0},dialogVideoOK:function(){},dialogVideoCancel:function(){},uploadProgress:function(t,e){console.log("e:"+t)},uploadGallerySuccess:function(t,e,o){var a=this;console.log(t),this.videos.push({name:e.name,url:t.data.url});var i={name:e.name,url:t.data.url,categoryid:this.selectCategoryId};X(i).then((function(t){a.videos[a.videos.length-1].id=t.data.id,console.log(t)})).catch((function(t){console.log("err "+t)}))},uploadVideoError:function(t,e,o){console.log(t)},treeOK:function(){console.log("Data:"+this.treeData)},nodeClick:function(t,e){var o=this;console.log("nodeclick"),void 0!=e.children&&0!=e.children.length||(this.selectCategoryId=e.id,this.selectCategoryName=e.name,Y({id:this.selectCategoryId}).then((function(t){o.cover=t.data.data.cover,o.categoryInfo=t.data.data.gallerys;for(var e=[],a=0;a<o.categoryInfo.length;a++)e.push({name:o.categoryInfo[a].name,url:o.categoryInfo[a].url});o.videos=e})).catch((function(t){console.log("categoryinfo err"+t)})))},renderTreeContent:function(t,e){e.root,e.node;var o=e.data;return t("span",{style:{display:"inline-block",width:"100%"}},[t("span",{style:{display:"inline-block",width:"200px"}},[t("span",o.name)])])},fileClick:function(){document.getElementById("upload_file").click()},uploadMore:function(){},fileChange:function(t){t.target.files[0].size&&(this.fileList(t.target),t.target.value="")},fileList:function(t){for(var e=t.files,o=0;o<e.length;o++)""!=e[o].type?this.fileAdd(e[o]):this.folders(t.items[o])},folders:function(t){var e=this;t.kind&&(t=t.webkitGetAsEntry()),t.createReader().readEntries((function(t){for(var o=0;o<t.length;o++)t[o].isFile?e.foldersAdd(t[o]):e.folders(t[o])}))},foldersAdd:function(t){var e=this;t.file((function(t){e.fileAdd(t)}))},fileAdd:function(t){if(this.size=this.size+t.size,-1==t.type.indexOf("image"))this.imgList.push({file:t,persent:0});else{var e=new FileReader;e.vue=this,e.readAsDataURL(t),e.onload=function(){t.src=this.result,this.vue.imgList.push({file:t,persent:0})}}},fileDel:function(t){this.size=this.size-this.imgList[t].file.size,this.imgList.splice(t,1)},bytesToSize:function(t){if(0===t)return"0 B";var e=1e3,o=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],a=Math.floor(Math.log(t)/Math.log(e));return(t/Math.pow(e,a)).toPrecision(3)+" "+o[a]},dragenter:function(t){t.stopPropagation(),t.preventDefault()},dragover:function(t){t.stopPropagation(),t.preventDefault()},drop:function(t){t.stopPropagation(),t.preventDefault(),this.fileList(t.dataTransfer)}}},_t=It,St=(o("8908"),Object(l["a"])(_t,At,kt,!1,null,"930a3aaa",null)),Dt=St.exports,Rt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("Row",[o("Col",{attrs:{span:"5"}},[t._v("章节")]),o("Col",{attrs:{span:"6"}},[t._v("图片名")]),o("Col",{attrs:{span:"4"}},[t._v("封面")]),o("Col",{attrs:{span:"4"}},[t._v("图片地址")]),o("Col",{attrs:{span:"2"}},[t._v("排序")]),o("Col",{attrs:{span:"3"}},[t._v("操作")])],1),t._l(t.list,(function(e){return o("Row",{key:e.id,staticClass:"row-item"},[o("Col",{staticClass:"row-col",attrs:{span:"5"}},[t._v(t._s(e.categoryname))]),o("Col",{staticClass:"row-col",attrs:{span:"6"}},[t._v(t._s(e.name))]),o("Col",{staticClass:"row-col",attrs:{span:"4"}},[o("img",{staticStyle:{width:"40px",height:"40px","vertical-align":"middle"},attrs:{src:e.url}})]),o("Col",{staticClass:"row-col",attrs:{span:"4"}},[o("p",{staticStyle:{"text-overflow":"ellipsis","white-space":"nowrap","max-width":"100px"}},[t._v(t._s(e.url))])]),o("Col",{staticClass:"row-col",attrs:{span:"2"}},[t._v(t._s(e.sort))]),o("Col",{staticClass:"row-col",attrs:{sapn:"3"}},[o("span",{staticStyle:{"text-align":"center"},on:{click:function(o){return t.deleteGalleryClick(e.id)}}},[t._v("删除")])])],1)})),o("Page",{attrs:{total:t.total,current:t.page},on:{"on-change":t.changePage}})],2)},Bt=[],Vt={name:"WidgetGalleryList",data:function(){return{list:[],page:0,total:0}},mounted:function(){this.page=1,this.changePage(1)},updated:function(){console.log("update")},methods:{loadList:function(){this.changePage(this.page)},changePage:function(t){var e=this;this.page=t,J({page:t,size:10}).then((function(t){console.log(t),e.list=t.data.data.list,e.total=t.data.data.total})).catch((function(t){console.log(t)}))},deleteGalleryClick:function(t){var e=this;console.log(t);var o={id:t};Z(o).then((function(t){if(console.log("删除图片数据返回："+t+" list:"+e.list),t.data.data)for(var o=0;o<e.list.length;o++)if(e.list[o].id==t.data.data.id){e.list.splice(o,1);break}})).catch((function(t){console.log("删除图片数据错误")}))}}},Ot=Vt,Lt=(o("dff5"),Object(l["a"])(Ot,Rt,Bt,!1,null,"6dbaf962",null)),zt=Lt.exports,Et={name:"gallery",components:{GalleryList:zt,NodePopWin:Nt,GalleryUpload:Dt},provide:function(){return{reload:this.reload}},data:function(){var t=this;return{isRouterAlive:!0,rootName:"",currentSelect:1,currentNode:"",currentNodeKey:0,currentNodeId:0,isEditor:!1,rootNodes:[],currentRootNode:{},renderFun:function(e,o){o.root,o.node;var a=o.data;return e("span",{style:{display:"inline-block",width:"100%"}},[e("span",[e("Icon",{props:{type:"ios-folder-outline"},style:{marginRight:"8px"}}),e("span",a.name)]),e("span",{style:{display:"inline-block",float:"right",marginRight:"32px"}},[e("Button",{props:Object.assign({},t.buttonProps,{icon:"ios-add",type:"primary"}),style:{marginLeft:"30px",width:"64px"},on:{click:function(){return t.showNodeDialog(!1,a)}}})])])},categoryArr:[],ClassifyData:[],isShowRoot:!0}},mounted:function(){this.categoryList()},methods:{clickTabs:function(t){console.log(t),2==t&&this.$refs.galleryList.loadList()},reload:function(){this.isRouterAlive=!1,this.$nextTick((function(){this.isRouterAlive=!0}))},rootNodeClick:function(t){console.log("root click "+t),this.currentRootNode=t},editRoot:function(){this.showNodeDialog(!0,this.currentRootNode)},deleteRoot:function(){void 0!=this.currentRootNode.id&&this.deleteNode(this.currentRootNode)},createRoot:function(){var t=this;if(console.log("创建根节点"),this.rootName){var e={name:this.rootName,pid:0,sort:0};W(e).then((function(e){console.log("创建节点成功："+e),t.categoryArr=t.ClassifyData,t.parseCategory([e.data.data]),t.ClassifyData=t.categoryArr,t.reload()})).catch((function(t){console.log("创建节点失败")}))}else Object(vt["a"])("请输入正确的节点名")},categoryList:function(){var t=this;F().then((function(e){console.log(e),0==e.data.data.length?t.isShowRoot=!0:(t.categoryArr=[],t.rootNodes=[],t.parseCategory(e.data.data),t.ClassifyData=t.categoryArr)})).catch((function(t){console.log(t)}))},parseCategory:function(t){for(var e=t.length,o=0;o<e;o++)if(0==t[o].pid){var a={name:t[o].name,expand:!0,id:t[o].id,sort:t[o].sort,pid:0,render:this.renderFun};void 0==this.currentRootNode.id&&(this.currentRootNode={id:a.id,content:a.name,name:a.name}),this.rootNodes.push({id:a.id,content:a.name,name:a.name}),this.categoryArr.push(a),t.splice(o,1),o--,e--}else{var i=this.getCategoryArrItem(this.categoryArr,t[o].pid);if(i){var n={name:t[o].name,expand:!0,id:t[o].id,sort:t[o].sort,pid:t[o].pid};void 0==i.children&&(i.children=[]),i.children.push(n),t.splice(o,1),o--,e--}}t.length>0&&this.parseCategory(t)},getCategoryArrItem:function(t,e){for(var o=0;o<t.length;o++){if(t[o].id==e)return t[o];if(t[o].children&&t[o].children.length>0){var a=this.getCategoryArrItem(t[o].children,e);if(a)return a}}},selectClassify:function(t){this.currentSelect=t},popWinCB:function(t){var e=this;if(console.log(t),this.isEditor){var o={name:t,id:this.currentNodeId};U(o).then((function(t){console.log("更新节点成功");var o=e.getCategoryArrItem(e.ClassifyData,t.data.data.id);o&&(t.data.data.sort?o.sort=t.data.data.sort:t.data.data.name&&(o.name=t.data.data.name),e.currentRootNode&&e.currentRootNode.id==t.data.data.id&&(e.currentRootNode.name=t.data.data.name),e.reload())})).catch((function(t){console.log("更新节点失败")}))}else{var a={name:t,pid:this.currentNodeId,sort:0};W(a).then((function(t){console.log("创建节点成功："+t),e.categoryArr=e.ClassifyData,e.parseCategory([t.data.data]),e.ClassifyData=e.categoryArr,e.reload()})).catch((function(t){console.log("创建节点失败")}))}},updateNodeName:function(t,e,o){if(0!=t.length)for(var a=0;a<t.length;a++){if(t[a].nodeKey==o)return;t[a].children&&t[a].children.length&&this.updateNodeName(t[a].children,e,o)}},deleteNode:function(t){var e=this,o=[],a=this.getCategoryArrItem(this.ClassifyData,t.id);if(a){o.push(a.id);for(var i=this.getAllChildrenNode(a),n=0;n<i.length;n++)o.push(i[n]);console.log("delete:"+JSON.stringify(o));var s={ids:JSON.stringify(o)};G(s).then((function(t){if(t.data.data.number>0){if(e.deleteTreeNodeById(a.id),console.log("delete succes:"+t),e.currentRootNode&&e.currentRootNode.id==a.id){for(var o=0;o<e.rootNodes.length;o++)if(e.rootNodes[o].id==a.id){e.rootNodes.splice(o,1);break}e.rootNodes.length>0&&(e.currentRootNode=e.rootNodes[0])}e.reload()}})).catch((function(t){console.log("delete category:"+t)}))}},getAllChildrenNode:function(t){var e=[];if(t.children)for(var o=0;o<t.children.length;o++)if(e.push(t.children[o].id),t.children[o].children&&t.children[o].children.length>0)for(var a=this.getAllChildrenNode(t.children[o]),i=0;i<a.length;i++)e.push(a[i]);return e},deleteTreeNodeById:function(t){this.findTreeNodeById(this.ClassifyData,t)},findTreeNodeById:function(t,e){for(var o=0;o<t.length;o++){if(t[o].id==e)return void t.splice(o,1);t[o].children&&t[o].children.length>0&&this.findTreeNodeById(t[o].children,e)}},showNodeDialog:function(t,e){console.log("node click:"+e.name),this.isEditor=t,this.currentNodeId=e.id,this.$refs.popwin.showCustomTextConfirm(e.name)},uploadCoverImgComplete:function(t){console.log(t)},renderContent:function(t,e){var o=this,a=(e.root,e.node,e.data);return t("span",{style:{display:"inline-block",width:"100%"}},[t("span",{style:{display:"inline-block",width:"200px"}},[t("Icon",{props:{type:"ios-paper-outline"},style:{marginRight:"8px"}}),t("span",a.name)]),t("span",{style:{display:"inline-block",float:"right",marginRight:"32px"}},[t("Button",{domProps:{value:"编辑",innerHTML:"编辑"},style:{marginRight:"20px"},on:{click:function(){return o.showNodeDialog(!0,a)}}}),t("Button",{props:Object.assign({},this.buttonProps,{icon:"ios-add"}),style:{marginRight:"8px"},on:{click:function(){return o.showNodeDialog(!1,a)}}}),t("Button",{props:Object.assign({},this.buttonProps,{icon:"ios-remove"}),on:{click:function(){return o.deleteNode(a)}}})])])},append:function(t){var e=t.children||[];e.push({title:"appended node",expand:!0}),this.$set(t,"children",e)},remove:function(t,e,o){var a=t.find((function(t){return t===e})).parent,i=t.find((function(t){return t.nodeKey===a})).node,n=i.children.indexOf(o);i.children.splice(n,1)}}},Tt=Et,Mt=(o("876b"),Object(l["a"])(Tt,gt,mt,!1,null,"9bd85856",null)),Pt=Mt.exports,jt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticStyle:{"text-align":"left"}},[o("Button",{staticClass:"btn-tab",attrs:{type:"primary"},on:{click:function(e){return t.selectClassify(1)}}},[t._v("视频分类")]),o("Button",{staticClass:"btn-tab",attrs:{type:"primary"},on:{click:function(e){return t.selectClassify(2)}}},[t._v("上传视频")]),o("Button",{staticClass:"btn-tab",attrs:{type:"primary"},on:{click:function(e){return t.selectClassify(3)}}},[t._v("视频列表")])],1),o("div",[o("div",{directives:[{name:"show",rawName:"v-show",value:1==t.currentSelect,expression:"currentSelect == 1"}],staticStyle:{"text-align":"left"}},[o("Row",{directives:[{name:"show",rawName:"v-show",value:t.isShowRoot,expression:"isShowRoot"}],staticStyle:{"margin-top":"10px","line-height":"40px"}},[o("Col",{staticStyle:{"vertical-align":"middle"},attrs:{span:"8"}},[o("van-field",{attrs:{placeholder:"请输入根节点"},model:{value:t.rootName,callback:function(e){t.rootName=e},expression:"rootName"}})],1),o("Col",{staticStyle:{height:"40px","line-height":"40px"},attrs:{span:"4"}},[o("Button",{staticStyle:{"vertical-align":"middle"},attrs:{type:"primary"},on:{click:t.createRoot}},[t._v("创建根节点")])],1),o("Col",{staticStyle:{"vertical-align":"middle"},attrs:{span:"12"}},[o("v-dropdown",{attrs:{data:t.rootNodes},on:{"item-click":t.rootNodeClick}},[o("a",{staticClass:"ant-dropdown-link ant-dropdown-trigger",attrs:{href:"javascript:void(0)"}},[o("span",{staticClass:"tag_font"},[t._v("选择根节点")]),t._v(" "),o("v-icon",{attrs:{type:"down"}})],1)]),o("span",{staticStyle:{"font-size":"16px"}},[t._v(t._s(t.currentRootNode.content))]),o("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:t.editRoot}},[t._v("编辑")]),o("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:t.deleteRoot}},[t._v("删除")])],1)],1),o("Row",{staticClass:"modify-row"},[o("Col",{staticClass:"item",attrs:{span:"16"}},[t._v("排序")]),o("Col",{staticClass:"item",attrs:{span:"4"}},[t._v("排序")]),o("Col",{staticClass:"item",attrs:{span:"4"}},[t._v("操作")])],1),o("div",{staticClass:"scrollbar"},[t.isRouterAlive?o("Tree",{staticClass:"tree-render",attrs:{render:t.renderContent,data:t.ClassifyData}}):t._e()],1)],1),o("div",{directives:[{name:"show",rawName:"v-show",value:2==t.currentSelect,expression:"currentSelect == 2"}],staticStyle:{"margin-left":"10px"}},[o("span",[t._v("上传视频")]),o("VideoUpload",{attrs:{treeData:t.ClassifyData}})],1),o("div",{directives:[{name:"show",rawName:"v-show",value:3==t.currentSelect,expression:"currentSelect == 3"}],staticStyle:{"margin-left":"10px"}},[o("span",[t._v("视频列表")]),o("VideoList",{on:{select:t.uploadCoverImgComplete}})],1)]),o("NodePopWin",{ref:"popwin",attrs:{nodeName:t.currentNode},on:{select:t.popWinCB}})],1)},Kt=[],Ft=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"grid-demo"},[a("div",{staticClass:"overview"},[a("v-row",{staticClass:"demo-row row-nd"},[a("v-col",{staticClass:"demo-col demo-col-1",attrs:{span:"4"}},[t._v("选择分类")]),a("v-col",{staticClass:"demo-col demo-col-1",attrs:{span:"4"}},[a("Button",{on:{click:t.showSelectTree}},[t._v(t._s(t.selectCategoryName))])],1),a("v-col",{staticClass:"demo-col demo-col-2",attrs:{span:"16"}},[t._v("备注：只能选择到三级分类")])],1),a("v-row",{staticClass:"demo-row row-nd"},[a("v-col",{staticClass:"demo-col demo-col-1",attrs:{span:"4"}},[t._v("上传封面")]),a("v-col",{staticClass:"demo-col demo-col-1",attrs:{span:"4"}},[a("Button",{on:{click:t.showSelectImg}},[t._v("上传封面图")])],1),a("v-col",{staticClass:"demo-col demo-col-2",attrs:{span:"16"}},[t._v("备注：只能选择到三级分类")])],1),a("v-row",{staticClass:"demo-row",staticStyle:{"text-align":"left"}},[a("img",{directives:[{name:"show",rawName:"v-show",value:void 0!=this.cover&&this.cover.length>0,expression:"this.cover != undefined && this.cover.length > 0"}],staticStyle:{width:"50px",height:"50px","margin-left":"70px"},attrs:{src:this.cover}})]),a("v-row",{staticClass:"demo-row row-nd",staticStyle:{"margin-top":"10px"}},[a("v-col",{staticClass:"demo-col demo-col-1",attrs:{span:"4"}},[t._v("添加视频")]),a("v-col",{staticClass:"demo-col demo-col-1",attrs:{span:"4"}},[a("Button",{on:{click:t.showSelectVideo}},[t._v("上传视频")])],1),a("v-col",{directives:[{name:"show",rawName:"v-show",value:1==t.schoolid,expression:"schoolid==1"}],staticClass:"demo-col demo-col-1",attrs:{span:"2"}},[a("Button",{on:{click:t.showCCSelectVideo}},[t._v("填写cc视频id")])],1),a("v-col",{staticClass:"demo-col demo-col-2",attrs:{span:"12"}},[t._v("备注：只能选择到三级分类")])],1)],1),a("v-row",{staticClass:"demo-row"},[a("List",{attrs:{"item-layout":"vertical"}},t._l(t.videos,(function(e){return a("ListItem",{key:e.name,staticStyle:{"text-align":"left"}},[a("span",{staticStyle:{width:"200px","word-wrap":"break-word","word-break":"break-all"}},[t._v(t._s(e.name))]),a("img",{staticStyle:{width:"50px",height:"50px"},attrs:{src:o("f5a3")}})])})),1)],1),a("Modal",{on:{"on-ok":t.treeOK},model:{value:t.showTreeNode,callback:function(e){t.showTreeNode=e},expression:"showTreeNode"}},[a("div",{staticClass:"scrollbar"},[a("Tree",{staticClass:"tree-render tree",attrs:{render:t.renderTreeContent,data:t.treeData},on:{"on-select-change":t.nodeClick}})],1)]),a("Modal",{attrs:{title:t.dialogtitle},on:{"on-ok":t.dialogOK,"on-cancel":t.dialogCancel},model:{value:t.showDialog,callback:function(e){t.showDialog=e},expression:"showDialog"}},[a("Upload",{ref:"file",attrs:{action:"http://server.yimios.com/api/upload/uploadImageFile","before-upload":t.selectImage,"on-success":t.uploadSuccess,"on-error":t.uploadError,headers:t.header,data:t.filedata}},[a("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v("上传封面图")])],1)],1),a("Modal",{attrs:{title:t.dialogvideotitle},on:{"on-ok":t.dialogVideoOK,"on-cancel":t.dialogVideoCancel},model:{value:t.showVideoDialog,callback:function(e){t.showVideoDialog=e},expression:"showVideoDialog"}},[a("Upload",{ref:"file",attrs:{action:"http://server.yimios.com/api/upload/uploadImageFile","before-upload":t.selectVideo,"on-success":t.uploadVideoSuccess,"on-error":t.uploadVideoError,headers:t.videoheader,data:t.videodata}},[a("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v("上传视频")])],1)],1),a("Modal",{attrs:{title:t.dialogvideotitle},on:{"on-ok":t.dialogCCVideoOK,"on-cancel":t.dialogCCVideoCancel},model:{value:t.showCCVideoDialog,callback:function(e){t.showCCVideoDialog=e},expression:"showCCVideoDialog"}},[a("Form",{attrs:{model:t.formItem}},[a("FormItem",{attrs:{label:"视频名"}},[a("Input",{attrs:{placeholder:"输入视频名"},model:{value:t.ccVideoName,callback:function(e){t.ccVideoName=e},expression:"ccVideoName"}})],1),a("FormItem",{attrs:{label:"视频ID"}},[a("Input",{attrs:{placeholder:"输入CC视频ID"},model:{value:t.ccVideoId,callback:function(e){t.ccVideoId=e},expression:"ccVideoId"}})],1)],1)],1),a("Spin",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],attrs:{fix:""}},[a("div",{staticClass:"loader"},[a("svg",{staticClass:"circular",attrs:{viewBox:"25 25 50 50"}},[a("circle",{staticClass:"path",attrs:{cx:"50",cy:"50",r:"20",fill:"none","stroke-width":"5","stroke-miterlimit":"10"}})])])])],1)},Wt=[],Ut={name:"WidgetVideoUpload",components:{},props:{treeData:[]},data:function(){return{dialogtitle:"视频封面图上传",dialogvideotitle:"视频上传",selectCategoryName:"请选择分类",selectCategoryId:0,schoolid:S(),cover:"",videos:[],videoUrl:"",showDialog:!1,showVideoDialog:!1,showCCVideoDialog:!1,showTreeNode:!1,file:null,header:{},filedata:{},categoryid:0,video:null,videodata:{},videoheader:{},loading:!1,categoryInfo:[],ccVideoName:"",ccVideoId:""}},mounted:function(){this.filedata.type="imgs",this.videodata.type="videos",console.log("schoolid"+this.schoolid)},methods:{showSelectTree:function(){this.showTreeNode=!0},showSelectImg:function(){0==this.selectCategoryId?Object(vt["a"])("请选择课程节点"):(this.showDialog=!0,this.header["art-token"]=I())},selectImage:function(t){return this.file=t,this.loading=!0,!0},dialogOK:function(){console.log("ok")},dialogCancel:function(){console.log("cancel")},uploadSuccess:function(t,e,o){var a=this;console.log(t),this.cover=t.data.url;var i={id:this.selectCategoryId,cover:this.cover};E(i).then((function(t){a.loading=!1})).catch((function(t){console.log("updatecategory err "+t),a.loading=!1}))},uploadError:function(t,e,o){console.log(t)},showSelectVideo:function(){0==this.selectCategoryId?Object(vt["a"])("请先选择课程节点或封面图片"):(this.showVideoDialog=!0,this.videoheader["art-token"]=I())},showCCSelectVideo:function(){0==this.selectCategoryId?Object(vt["a"])("请先选择课程节点或封面图片"):(this.showCCVideoDialog=!0,this.videoheader["art-token"]=I())},selectVideo:function(t){return this.video=t,!0},dialogCCVideoOK:function(){var t=this;if(this.ccVideoId&&this.ccVideoName){this.videos.push({name:this.ccVideoName,ccid:this.ccVideoId});var e={name:this.ccVideoName,ccid:this.ccVideoId,categoryid:this.selectCategoryId};j(e).then((function(e){t.videos[t.videos.length-1].id=e.data.id,console.log(e)})).catch((function(t){console.log("err "+t)}))}else Object(vt["a"])("")},dialogCCVideoCancel:function(){},dialogVideoOK:function(){},dialogVideoCancel:function(){},uploadVideoSuccess:function(t,e,o){var a=this;console.log(t),this.videos.push({name:e.name,url:t.data.url});var i={name:e.name,url:t.data.url,categoryid:this.selectCategoryId};j(i).then((function(t){a.videos[a.videos.length-1].id=t.data.id,console.log(t)})).catch((function(t){console.log("err "+t)}))},uploadVideoError:function(t,e,o){console.log(t)},treeOK:function(){console.log("Data:"+this.treeData)},nodeClick:function(t,e){var o=this;console.log("nodeclick"),void 0!=e.children&&0!=e.children.length||(this.selectCategoryId=e.id,this.selectCategoryName=e.name,P({id:this.selectCategoryId}).then((function(t){o.cover=t.data.data.cover,o.categoryInfo=t.data.data.videolist;for(var e=[],a=0;a<o.categoryInfo.length;a++)e.push({name:o.categoryInfo[a].name});o.videos=e})).catch((function(t){console.log("categoryinfo err"+t)})))},renderTreeContent:function(t,e){e.root,e.node;var o=e.data;return t("span",{style:{display:"inline-block",width:"100%"}},[t("span",{style:{display:"inline-block",width:"200px"}},[t("span",o.name)])])}}},Gt=Ut,Yt=(o("54b4"),Object(l["a"])(Gt,Ft,Wt,!1,null,"4edbc796",null)),Xt=Yt.exports,Jt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("Row",[o("Col",{attrs:{span:"5"}},[t._v("章节")]),o("Col",{attrs:{span:"6"}},[t._v("视频名")]),o("Col",{attrs:{span:"4"}},[t._v("封面")]),o("Col",{attrs:{span:"4"}},[t._v("视频地址")]),o("Col",{attrs:{span:"2"}},[t._v("排序")]),o("Col",{attrs:{span:"3"}},[t._v("操作")])],1),t._l(t.list,(function(e){return o("Row",{key:e.name,staticClass:"row-item"},[o("Col",{staticClass:"row-col",attrs:{span:"5"}},[t._v(t._s(e.categoryname))]),o("Col",{staticClass:"row-col",attrs:{span:"6"}},[t._v(t._s(e.name))]),o("Col",{staticClass:"row-col",attrs:{span:"4"}},[o("img",{staticStyle:{width:"40px",height:"40px","vertical-align":"middle"},attrs:{src:e.cover}})]),o("Col",{staticClass:"row-col",attrs:{span:"3"}},[o("span",{staticClass:"video_url",staticStyle:{"text-overflow":"ellipsis","white-space":"nowrap","max-width":"100px"}},[t._v(t._s(e.url))])]),o("Col",{staticClass:"row-col",attrs:{span:"3"}},[e.sort?o("span",[t._v("序号:"+t._s(e.sort))]):t._e(),e.sort?t._e():o("span",[t._v("序号:0")]),o("span",{staticStyle:{"margin-left":"10px",border:"1px solid gray",padding:"5px"},on:{click:function(o){return t.showSortDialog(e.id)}}},[t._v("排序")])]),o("Col",{staticClass:"row-col",attrs:{sapn:"3"}},[o("span",{staticStyle:{"text-align":"center"},on:{click:function(o){return t.deleteVideo(e.id)}}},[t._v("删除")])])],1)})),o("Page",{attrs:{total:t.total,current:t.page,simple:"",onchange:"changePage"}}),o("Modal",{attrs:{title:t.排序},on:{"on-ok":t.clickSortOK,"on-cancel":t.clickSortCancel},model:{value:t.showSort,callback:function(e){t.showSort=e},expression:"showSort"}},[o("Form",{attrs:{model:t.formItem}},[o("FormItem",{attrs:{label:"序号"}},[o("Input",{attrs:{placeholder:"输入序号"},model:{value:t.sortNo,callback:function(e){t.sortNo=e},expression:"sortNo"}})],1)],1)],1)],2)},Zt=[],Ht={name:"WidgetVideoList",data:function(){return{list:[],page:0,total:0,showSort:!1,sortNo:0,id:0}},mounted:function(){this.page=1,this.changePage(1)},updated:function(){console.log("update")},methods:{changePage:function(t){var e=this;this.page=t,K({page:t,size:10}).then((function(t){console.log(t),e.list=t.data.data.list,e.total=t.data.data.total})).catch((function(t){console.log(t)}))},deleteVideo:function(t){console.log(t)},showSortDialog:function(t){this.id=t,this.showSort=!0},clickSortOK:function(){var t=this;if(this.id&&this.sortNo>0){var e={id:this.id,sort:this.sortNo};T(e).then((function(o){t.updateListData(e.id,e.sort),Object(vt["a"])("更新成功")})).catch((function(t){console.log("updatecategory err "+t)}))}else Object(vt["a"])("输入正确的内容")},clickSortCancel:function(){},updateListData:function(t,e){for(var o=0;o<this.list.length;o++)if(this.list[o].id==t){this.list[o].sort=e;break}}}},qt=Ht,Qt=(o("4446"),Object(l["a"])(qt,Jt,Zt,!1,null,"bfc82486",null)),$t=Qt.exports,te={name:"article",components:{NodePopWin:Nt,VideoUpload:Xt,VideoList:$t},inject:["reload"],provide:function(){return{reload:this.reload}},data:function(){var t=this;return{isShowRoot:!0,rootName:"",isRouterAlive:!0,currentSelect:1,currentNode:"",currentNodeKey:0,currentNodeId:0,isEditor:!1,rootNodes:[],currentRootNode:{},renderFun:function(e,o){o.root,o.node;var a=o.data;return e("span",{style:{display:"inline-block",width:"100%"}},[e("span",[e("Icon",{props:{type:"ios-folder-outline"},style:{marginRight:"8px"}}),e("span",a.name)]),e("span",{style:{display:"inline-block",float:"right",marginRight:"32px"}},[e("Button",{props:Object.assign({},t.buttonProps,{icon:"ios-add",type:"primary"}),style:{marginLeft:"30px",width:"64px"},on:{click:function(){return t.showNodeDialog(!1,a)}}})])])},categoryArr:[],ClassifyData:[],buttonProps:{type:"default",size:"small"}}},mounted:function(){this.categoryList()},methods:{reload:function(){this.isRouterAlive=!1,this.$nextTick((function(){this.isRouterAlive=!0}))},rootNodeClick:function(t){console.log("root click "+t),this.currentRootNode=t},editRoot:function(){this.showNodeDialog(!0,this.currentRootNode)},deleteRoot:function(){void 0!=this.currentRootNode.id&&this.deleteNode(this.currentRootNode)},createRoot:function(){var t=this;if(console.log("创建根节点"),this.rootName){var e={name:this.rootName,pid:0,sort:0};O(e).then((function(e){console.log("创建节点成功："+e),t.isShowRoot=!0,t.categoryArr=t.ClassifyData,t.parseCategory([e.data.data]),t.ClassifyData=t.categoryArr,t.reload()})).catch((function(t){console.log("创建节点失败")}))}else Object(vt["a"])("请输入正确的节点名")},categoryList:function(){var t=this;V().then((function(e){console.log(e),0==e.data.data.length?t.isShowRoot=!0:(t.categoryArr=[],t.rootNodes=[],t.parseCategory(e.data.data),t.ClassifyData=t.categoryArr)})).catch((function(t){console.log(t)}))},parseCategory:function(t){for(var e=t.length,o=0;o<e;o++)if(0==t[o].pid){var a={name:t[o].name,expand:!0,id:t[o].id,sort:t[o].sort,pid:0,render:this.renderFun};void 0==this.currentRootNode.id&&(this.currentRootNode={id:a.id,content:a.name,name:a.name}),this.rootNodes.push({id:a.id,content:a.name,name:a.name}),this.categoryArr.push(a),t.splice(o,1),o--,e--}else{var i=this.getCategoryArrItem(this.categoryArr,t[o].pid);if(i){var n={name:t[o].name,expand:!0,id:t[o].id,sort:t[o].sort,pid:t[o].pid};void 0==i.children&&(i.children=[]),i.children.push(n),t.splice(o,1),o--,e--}}t.length>0&&this.parseCategory(t)},getCategoryArrItem:function(t,e){for(var o=0;o<t.length;o++){if(t[o].id==e)return t[o];if(t[o].children&&t[o].children.length>0){var a=this.getCategoryArrItem(t[o].children,e);if(a)return a}}},addCategory:function(t,e){var o={name:t,pid:e,sort:0};O(o).then((function(t){console.log("addcategory success:"+t)})).catch((function(t){console.log("addcategory:"+t)}))},selectClassify:function(t){this.currentSelect=t},popWinCB:function(t){var e=this;if(console.log(t),this.isEditor){var o={name:t,id:this.currentNodeId};E(o).then((function(t){console.log("更新节点成功");var o=e.getCategoryArrItem(e.ClassifyData,t.data.data.id);o&&(t.data.data.sort?o.sort=t.data.data.sort:t.data.data.name&&(o.name=t.data.data.name),e.currentRootNode&&e.currentRootNode.id==t.data.data.id&&(e.currentRootNode.name=t.data.data.name),e.reload())})).catch((function(t){console.log("更新节点失败")}))}else{var a={name:t,pid:this.currentNodeId,sort:0};O(a).then((function(t){console.log("创建节点成功："+t),e.categoryArr=e.ClassifyData,e.parseCategory([t.data.data]),e.ClassifyData=e.categoryArr,e.reload()})).catch((function(t){console.log("创建节点失败")}))}},updateNodeName:function(t,e,o){if(0!=t.length)for(var a=0;a<t.length;a++){if(t[a].nodeKey==o)return;t[a].children&&t[a].children.length&&this.updateNodeName(t[a].children,e,o)}},deleteNode:function(t){var e=this,o=[],a=this.getCategoryArrItem(this.ClassifyData,t.id);if(a){o.push(a.id);for(var i=this.getAllChildrenNode(a),n=0;n<i.length;n++)o.push(i[n]);console.log("delete:"+JSON.stringify(o));var s={ids:JSON.stringify(o)};M(s).then((function(t){if(t.data.data.number>0){if(e.deleteTreeNodeById(a.id),console.log("delete succes:"+t),e.currentRootNode&&e.currentRootNode.id==a.id){for(var o=0;o<e.rootNodes.length;o++)if(e.rootNodes[o].id==a.id){e.rootNodes.splice(o,1);break}e.rootNodes.length>0&&(e.currentRootNode=e.rootNodes[0])}e.reload()}})).catch((function(t){console.log("delete category:"+t)}))}},getAllChildrenNode:function(t){var e=[];if(t.children)for(var o=0;o<t.children.length;o++)if(e.push(t.children[o].id),t.children[o].children&&t.children[o].children.length>0)for(var a=this.getAllChildrenNode(t.children[o]),i=0;i<a.length;i++)e.push(a[i]);return e},deleteTreeNodeById:function(t){this.findTreeNodeById(this.ClassifyData,t)},findTreeNodeById:function(t,e){for(var o=0;o<t.length;o++){if(t[o].id==e)return void t.splice(o,1);t[o].children&&t[o].children.length>0&&this.findTreeNodeById(t[o].children,e)}},showNodeDialog:function(t,e){console.log("node click:"+e.name),this.isEditor=t,this.currentNodeId=e.id,this.$refs.popwin.showCustomTextConfirm(e.name)},uploadCoverImgComplete:function(t){console.log(t)},renderContent:function(t,e){var o=this,a=(e.root,e.node,e.data);return t("span",{style:{display:"inline-block",width:"100%"}},[t("span",{style:{display:"inline-block",width:"200px"}},[t("Icon",{props:{type:"ios-paper-outline"},style:{marginRight:"8px"}}),t("span",a.name)]),t("span",{style:{display:"inline-block",float:"right",marginRight:"32px"}},[t("Button",{domProps:{value:"编辑",innerHTML:"编辑"},style:{marginRight:"20px"},on:{click:function(){return o.showNodeDialog(!0,a)}}}),t("Button",{props:Object.assign({},this.buttonProps,{icon:"ios-add"}),style:{marginRight:"8px"},on:{click:function(){return o.showNodeDialog(!1,a)}}}),t("Button",{props:Object.assign({},this.buttonProps,{icon:"ios-remove"}),on:{click:function(){return o.deleteNode(a)}}})])])},append:function(t){var e=t.children||[];e.push({title:"appended node",expand:!0}),this.$set(t,"children",e)},remove:function(t,e,o){var a=t.find((function(t){return t===e})).parent,i=t.find((function(t){return t.nodeKey===a})).node,n=i.children.indexOf(o);i.children.splice(n,1)}}},ee=te,oe=(o("6369"),Object(l["a"])(ee,jt,Kt,!1,null,"b7b7f972",null)),ae=oe.exports,ie=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[t._v(" 学员管理 "),o("div",[o("span",[t._v("创建学员账号")]),o("van-cell-group",[o("van-field",{attrs:{label:"账号",placeholder:"请输入账号"},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}}),o("van-field",{attrs:{label:"密码",placeholder:"请输入密码"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),o("Button",{attrs:{type:"primary"},on:{click:t.registerUser}},[t._v("创建账号")])],1),o("div",[o("Row",[o("Col",{attrs:{span:"5"}},[t._v("用户名")]),o("Col",{attrs:{span:"6"}},[t._v("密码")]),o("Col",{attrs:{span:"4"}},[t._v("操作")])],1),t._l(t.userlist,(function(e){return o("Row",{key:e.name,staticClass:"row-item"},[o("Col",{staticClass:"row-col",attrs:{span:"5"}},[t._v(t._s(e.username))]),o("Col",{staticClass:"row-col",attrs:{span:"6"}},[t._v(t._s(e.passwordtxt))]),o("Col",{staticClass:"row-col",attrs:{sapn:"3"}},[o("span",{staticStyle:{"text-align":"center"}},[t._v("删除")])])],1)})),o("Page",{attrs:{total:t.total,current:t.page,simple:"",onchange:"changePage"}})],2)])},ne=[],se={name:"member",data:function(){return{username:"",password:"",page:1,total:0,userlist:[]}},mounted:function(){this.getUsers()},methods:{registerUser:function(){var t=this;if(this.username&&this.password){var e={username:this.username,password:Q()(this.password),passwordtxt:this.password,role:2};L(e).then((function(e){console.log(e),t.userlist.push(e.data.data),t.total=t.userlist.length})).catch((function(t){console.log(t)}))}},getUsers:function(){var t=this;z({page:this.page,size:10}).then((function(e){t.userlist=e.data.data.data,t.total=e.data.data.totalPages})).catch((function(t){console.log(t)}))}}},re=se,le=Object(l["a"])(re,ie,ne,!1,null,"233a7280",null),ce=le.exports,de=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[t._v(" 在籍管理 ")])},ue=[],he={name:"studying"},pe=he,fe=Object(l["a"])(pe,de,ue,!1,null,"5cd17036",null),ge=fe.exports,me=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[t._v(" 班级管理 ")])},ve=[],ye={name:"ClassManager"},Ce=ye,we=Object(l["a"])(Ce,me,ve,!1,null,"696bcd5c",null),be=we.exports,xe=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"components-layout-demo-side"}},[o("v-layout",{staticClass:"layout"},[o("v-sider",{staticClass:"left-menu",attrs:{collapsible:""},model:{value:t.collapsed,callback:function(e){t.collapsed=e},expression:"collapsed"}},[o("v-menu",{attrs:{theme:"dark",mode:t.collapsed?"vertical":"inline",data:t.menu},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.data;return[o("span",{staticStyle:{"font-size":"16px"},on:{click:function(e){return t.menuClick(a.path,a.name)}}},[t._v(t._s(a.name))])]}}])})],1),o("v-layout",[o("v-header",{style:{background:"gray",padding:0}},[o("span",{staticStyle:{float:"left","margin-left":"20px","font-size":"16px"}},[t._v(t._s(t.selectMenu))]),o("span",{staticStyle:{float:"right","font-size":"16px"}},[t._v("退出登录")])]),o("v-content",[o("router-view")],1)],1)],1)],1)},Ne=[],Ae={name:"Home",data:function(){return{collapsed:!1,menu:[],selectMenu:""}},mounted:function(){void 0==this.$route.params&&void 0==this.$route.params.user||(this.menu=this.$route.params.user.data.menu)},methods:{openTest:function(){this.$router.push("/Home/school/manager")},menuClick:function(t,e){this.selectMenu=e,console.log(t),this.$router.push("/Home/"+t)}}},ke=Ae,Ie=(o("b889"),Object(l["a"])(ke,xe,Ne,!1,null,"e109fb08",null)),_e=Ie.exports;a["default"].config.productionTip=!1,a["default"].config.devtools=!0,a["default"].use(w.a),a["default"].use(f.a,h.a),a["default"].use(g["a"]),a["default"].use(v.a),a["default"].use(y["a"]);var Se=new g["a"]({routes:[{path:"/login",name:"/login",component:ot},{path:"/Home",name:"/Home",component:_e,children:[{path:"school/manager",component:ft},{path:"school/gallery",component:Pt},{path:"school/video",component:ae},{path:"school/setting",component:lt},{path:"school/member",component:ce},{path:"school/studying",component:ge},{path:"school/classmanager",component:be}]}]});new a["default"]({router:Se,render:function(t){return t(d)}}).$mount("#app")},"5c29":function(t,e,o){},6127:function(t,e,o){},6369:function(t,e,o){"use strict";o("6127")},"6d3f":function(t,e,o){},"85ec":function(t,e,o){},"876b":function(t,e,o){"use strict";o("8dc2")},8908:function(t,e,o){"use strict";o("5c29")},"8dc2":function(t,e,o){},"9c99":function(t,e,o){},b889:function(t,e,o){"use strict";o("cda1")},c0d8:function(t,e,o){"use strict";o("3af0")},cda1:function(t,e,o){},cf55:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAABUUExURQAAAMzMzMzMzMzMzMzMzM/Pz8/Pz8vLy87OzsvLy8zMzMzMzMzMzM/Pz8zMzMvLy8zMzMvLy8zMzMzMzM3Nzc3Nzc3NzczMzMzMzMzMzMvLy8zMzLsLSEQAAAAbdFJOUwC/kFCfEDBAP4Dw77AgoMDQz6/gYH9w329fT0LnGv8AAAHJSURBVFjD7ZfdkoMgDIUR+SlatdXadpf3f891FSqKgYCzd3uurDP5SkgCR0IIkb1OVy+JFdN5YifjLUHqfM1ZXE8Arr8AfUYOoCtlgloP0JE0qT2gTAQ0e4BMBJB/wB8DvsZRnACIuzuqGYD78kLlAh6my2s/hqMAyg6avw19mQRo/PlpMQChgfGU27TgTaTz72qfQVNvZzbQB6qa/n8fz+fitMhOFF7+5uius1vZFrfMBNiddXJIAvCX9torCVCs57jIAVDnIqB4wJd9KN2b5IYGMPtK1O5d9hmoam43GDDV/eV0kFeEJS8KAtjnSGDH8YTToaIcApi+mxry6cRXPHC0SD9+cjFb80AJErCuuqw9O0HIe3zzIICFzMDSVXceALCgmzBJPWEAC9sRs6sKBLCInzFnJghg+hwAiL+WYudtAMBx/E345ugYAMRzggTQ4/ULggWk+Dt2WdRgAbIvjF7b9RUcBZAhu4wBBAz5gAJ0MKBDARQMeKC8ModyGJStQhGpHrdG3z0a3D7QxfflWBwyVzsArDECuOE+rWDAIwpow4D4EroIgMcIKgKY+mQIfhzyKGAycfAX3q6M662cKRq45FBab2WjH2SZu1hgXeGOAAAAAElFTkSuQmCC"},de51:function(t,e,o){},dff5:function(t,e,o){"use strict";o("de51")},f5a3:function(t,e){t.exports="data:image/png;base64,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"}});
//# sourceMappingURL=app.b513ed15.js.map